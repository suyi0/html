<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        h3 {
            height: 200px;
        }
    </style>
</head>

<body>

    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>
    <h3>标题1</h3>


    <script>

        //节流函数--只执行一次后面一直调用的是(闭包)
        function throttle(fn, delay) {
            var valid = true; // 初始化一个标志位

            //每次调用返回的函数时，
            // 整个throttle函数会重新执行，
            // 导致valid被重新设置为true。
            // 但实际上，throttle只在创建闭包时执行一次，
            // 之后每次调用的是返回的那个函数，
            // 而该函数内部并没有重新初始化valid，
            // 只是修改它的值。
            return function () {//闭包
                if (!valid) {
                    return false; // 如果标志位为 false，直接退出
                }
                valid = false; // 设置为 false，阻止后续调用
                setTimeout(function () {
                    fn();       // 执行目标函数
                    valid = true; // 重置标志位为 true
                }, delay);
            };
        }


        window.onscroll = throttle(scrollHandle, 2000);

        function scrollHandle() {
            var scrollTop = document.documentElement.scrollTop
            console.log(scrollTop);
        }
    </script>
</body>

</html>